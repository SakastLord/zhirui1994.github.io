(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{16:function(e,n,t){"use strict";var r=t(23),a=t(2),o=t.n(a),i=t(3),s=t(18),c=t.n(s),u=t(10),l=t(4),p=new u.b.Entity("milestones"),d=new u.b.Entity("labels"),f=new u.b.Entity("comments"),h=new u.b.Entity("issues",{milestone:p,labels:{nodes:[d]},comments:{nodes:[f]}}),b=new u.b.Entity("repositories",{issue:h,issues:{nodes:[h]},labels:{nodes:[d]},milestones:{nodes:[p]}});function m(){var e=atob(l.a.token),n=new RegExp("(\\+".concat(l.a.owner,"\\+|\\+").concat(l.a.repo,"\\+)"),"g");return e.replace(n,"")}function y(){return w.apply(this,arguments)}function w(){return(w=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",c.a.post("https://api.github.com/graphql",{query:'query { \n                repository(owner: "'.concat(l.a.owner,'", name: "').concat(l.a.repo,'") {\n                    id,\n                    labels(first: 100) {\n                        nodes {\n                            id,\n                            name,\n                            color,\n                        } \n                    },\n                    milestones(first:100) {\n                        nodes {\n                            id,\n                            number,\n                            state,\n                            title,\n                        }\n                    },\n                    issues(last:20, states:OPEN, orderBy: {direction: DESC, field: UPDATED_AT}) {\n                        pageInfo {\n                            endCursor,\n                            startCursor,\n                            hasNextPage,\n                            hasPreviousPage\n                        },\n                        totalCount,\n                        nodes {\n                            id,\n                            title,\n                            number,\n                            createdAt,\n                            milestone {\n                                id\n                            },\n                            labels(first:100) {\n                                nodes {\n                                    id,\n                                }\n                            }\n                        }\n                    }\n                }\n            }')},{headers:{Authorization:"bearer ".concat(m())}}).then(function(e){return Object(u.a)(e.data.data.repository,b)}));case 1:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function g(e){return v.apply(this,arguments)}function v(){return(v=Object(i.a)(o.a.mark(function e(n){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",c.a.post("https://api.github.com/graphql",{query:'query { \n                repository(owner: "'.concat(l.a.owner,'", name: "').concat(l.a.repo,'") {\n                    id,\n                    issue(number: ').concat(n,") {\n                        id,\n                        title,\n                        number,\n                        bodyHTML,\n                        createdAt,\n                        milestone {\n                            id,\n                            number,\n                            state,\n                            title,\n                        },\n                        labels(first:100) {\n                            nodes {\n                                id,\n                                name,\n                                color,\n                            }\n                        },\n                        comments(last: 20) {\n                            nodes {\n                                id,\n                                author {\n                                    avatarUrl,\n                                    login,\n                                    url,\n                                },\n                                bodyHTML,\n                                createdAt,\n                            }\n                        }\n                    }\n                }\n            }")},{headers:{Authorization:"bearer ".concat(m())}}).then(function(e){return Object(u.a)(e.data.data.repository,b)}));case 1:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function k(){var e={scope:"public_repo, user",redirect_uri:encodeURIComponent(window.location.href),client_id:l.a.client_id},n=Object.keys(e).map(function(n){return"".concat(n,"=").concat(e[n])}).join("&");return"https://github.com/login/oauth/authorize?".concat(n)}function x(e){return j.apply(this,arguments)}function j(){return(j=Object(i.a)(o.a.mark(function e(n){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return"https://cors-anywhere.herokuapp.com/https://github.com/login/oauth/access_token",e.abrupt("return",c.a.post("https://cors-anywhere.herokuapp.com/https://github.com/login/oauth/access_token",{code:n,client_id:l.a.client_id,client_secret:l.a.client_secret},{headers:{Accept:"application/json"}}).then(function(e){return e&&e.data}));case 2:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function O(e){return _.apply(this,arguments)}function _(){return(_=Object(i.a)(o.a.mark(function e(n){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",c.a.post("https://api.github.com/graphql",{query:"query { \n            viewer {\n                email,\n                id,\n                login,\n                name,\n                url,\n                avatarUrl, \n            }\n        }"},{headers:{Authorization:n}}).then(function(e){return e&&e.data&&e.data.data&&e.data.data.viewer}));case 1:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function E(e){return q.apply(this,arguments)}function q(){return(q=Object(i.a)(o.a.mark(function e(n){var t,r,a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.id,r=n.content,a=n.token,e.abrupt("return",c.a.post("https://api.github.com/graphql",{query:'mutation {\n                addComment(input:{subjectId: "'.concat(t,'", body: "').concat(r,'"}) {\n                    commentEdge {\n                        node {\n                            id,\n                            bodyHTML,\n                            createdAt,\n                            author {\n                                avatarUrl,\n                                login,\n                                url,\n                            },\n                        }\n                    }\n                }\n            }')},{headers:{Authorization:a}}).then(function(e){var n=e&&e.data&&e.data.data&&e.data.data.addComment.commentEdge.node;if(n)return Object(u.a)(n,f)}));case 2:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function A(e,n){return T.apply(this,arguments)}function T(){return(T=Object(i.a)(o.a.mark(function e(n,t){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",c.a.post("https://api.github.com/graphql",{query:'query {\n                repository(owner: "'.concat(l.a.owner,'", name: "').concat(l.a.repo,'") {\n                    id\n                    ').concat(t?"":"labels(first: 100) {\n                            nodes {\n                                id\n                                name\n                                color\n                            }\n                        }\n                        milestones(first: 100) {\n                            nodes {\n                                id\n                                number\n                                state\n                                title\n                            }\n                        }","\n                    ").concat(void 0!==n?"issue(number: ".concat(n,") {\n                        id\n                        title\n                        number\n                        body\n                        milestone {\n                            id\n                        }\n                        labels(first: 100) {\n                            nodes {\n                                id\n                            }\n                        }\n                    }"):"","\n                    \n                }\n            }")},{headers:{Authorization:"bearer ".concat(m())}}).then(function(e){var n=e&&e.data&&e.data.data&&e.data.data.repository;return!!n&&Object(u.a)(n,b)}));case 1:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function z(e){return C.apply(this,arguments)}function C(){return(C=Object(i.a)(o.a.mark(function e(n){var t;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="repo:".concat(l.a.owner,"/").concat(l.a.repo," "),n&&n.milestone&&(t+="milestone:".concat(n.milestone," ")),n&&n.labels&&n.labels.length&&(t+=n.labels.map(function(e){return"label:".concat(e," ")}).join("")),n&&n.query&&(t+="".concat(n.query," ")),e.abrupt("return",c.a.post("https://api.github.com/graphql",{query:'query {\n                search(type: ISSUE, last: 20, query: "'.concat(t.trim(),'") {\n                    issueCount\n                    pageInfo {\n                        endCursor\n                        startCursor\n                        hasNextPage\n                        hasPreviousPage\n                    }\n                    nodes {\n                        ... on Issue {\n                            id,\n                            title,\n                            number,\n                            createdAt,\n                            milestone {\n                                id\n                            },\n                            labels(first:100) {\n                                nodes {\n                                    id,\n                                }\n                            }\n                        }\n                    }\n                }\n            }')},{headers:{Authorization:"bearer ".concat(m())}}).then(function(e){var n=e&&e.data&&e.data.data&&e.data.data.search;if(n){var t=Object(u.a)(n.nodes,[h]);return Object(r.a)({},n,{nodes:t.result,entities:t.entities})}return!1}));case 5:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function I(e){return P.apply(this,arguments)}function P(){return(P=Object(i.a)(o.a.mark(function e(n){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",c.a.post("https://api.github.com/repos/".concat(l.a.owner,"/").concat(l.a.repo,"/issues"),{title:n.title,body:n.body,milestone:n.milestone,labels:n.labels},{headers:{Authorization:"token ".concat(m())}}).then(function(e){var n=e&&e.data;if(n)return n.id=n.node_id,n.labels={nodes:n.labels.map(function(e){return e.id=e.node_id,e})},n.milestone.id=n.milestone.node_id,n.comments={nodes:[]},Object(u.a)(n,h)}));case 1:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function S(e){return U.apply(this,arguments)}function U(){return(U=Object(i.a)(o.a.mark(function e(n){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",c.a.patch("https://api.github.com/repos/".concat(l.a.owner,"/").concat(l.a.repo,"/issues/").concat(n.number),{title:n.title,body:n.body,milestone:n.milestone,labels:n.labels},{headers:{Authorization:"token ".concat(m())}}).then(function(e){var n=e&&e.data;if(n)return n.id=n.node_id,n.labels={nodes:n.labels.map(function(e){return e.id=e.node_id,e})},n.milestone.id=n.milestone.node_id,n.comments={nodes:[]},Object(u.a)(n,h)}));case 1:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}t.d(n,"h",function(){return y}),t.d(n,"e",function(){return g}),t.d(n,"d",function(){return k}),t.d(n,"j",function(){return x}),t.d(n,"f",function(){return O}),t.d(n,"a",function(){return E}),t.d(n,"g",function(){return A}),t.d(n,"i",function(){return z}),t.d(n,"b",function(){return I}),t.d(n,"c",function(){return S})},163:function(e,n,t){e.exports={loadingContainer:"style_loadingContainer__3Pquw"}},165:function(e,n,t){e.exports=t(362)},358:function(e,n,t){},362:function(e,n,t){"use strict";t.r(n);var r=t(0),a=t.n(r),o=t(160),i=t.n(o),s=t(161),c=t(89),u=t(23),l=t(21),p=t(2),d=t.n(p),f=t(3),h=t(16),b=t(63),m={name:"repository",state:{result:"",loading:!0,searchParams:{milestone:"*",labels:[],query:""}},reducers:{update:function(e,n){return b.merge(e,n)}},effects:function(e){return{initIndex:function(){var n=Object(f.a)(d.a.mark(function n(t,r){var a;return d.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r.repository.loading){n.next=3;break}return n.next=3,e.repository.update({loading:!0});case 3:return n.next=5,h.h();case 5:if(!(a=n.sent)){n.next=11;break}return n.next=9,e.entities.update(a.entities);case 9:return n.next=11,e.repository.update({result:a.result,loading:!1});case 11:case"end":return n.stop()}},n,this)}));return function(e,t){return n.apply(this,arguments)}}(),getSingleIssue:function(){var n=Object(f.a)(d.a.mark(function n(t,r){var a;return d.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r.repository.loading){n.next=3;break}return n.next=3,e.repository.update({loading:!0});case 3:return n.next=5,h.e(t);case 5:if(!(a=n.sent)){n.next=11;break}return n.next=9,e.entities.update(a.entities);case 9:return n.next=11,e.repository.update({result:a.result,loading:!1});case 11:case"end":return n.stop()}},n,this)}));return function(e,t){return n.apply(this,arguments)}}(),closeCurrentIssue:function(){var n=Object(f.a)(d.a.mark(function n(t,r){var a,o,i;return d.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(a=r.repository.result,!(o=r.entities.repositories[a])){n.next=7;break}return o.issue=void 0,i={repositories:Object(l.a)({},a,o)},n.next=7,e.entities.update(i);case 7:case"end":return n.stop()}},n,this)}));return function(e,t){return n.apply(this,arguments)}}(),initEditor:function(){var n=Object(f.a)(d.a.mark(function n(t,r){var a,o,i,s,c;return d.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(a=r.repository.result,o=r.entities.repositories[a],i=o&&o.labels&&o.labels.nodes.length&&o.milestones&&o.milestones.nodes.length,s=!t||o&&o.issue&&r.entities.issues[o.issue]&&r.entities.issues[o.issue].body,!i||!s){n.next=6;break}return n.abrupt("return");case 6:if(r.repository.loading){n.next=9;break}return n.next=9,e.repository.update({loading:!0});case 9:return n.next=11,h.g(t,i);case 11:if(!(c=n.sent)){n.next=17;break}return n.next=15,e.entities.update(c.entities);case 15:return n.next=17,e.repository.update({result:c.result,loading:!1});case 17:case"end":return n.stop()}},n,this)}));return function(e,t){return n.apply(this,arguments)}}(),searchIssues:function(){var n=Object(f.a)(d.a.mark(function n(t,r){var a,o,i,s,c,p;return d.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a=t.milestone,o=t.labels,i=t.query,n.next=3,e.repository.update({searchParams:{milestone:a,labels:o,query:i}});case 3:return n.next=5,h.i({milestone:a,labels:o,query:i});case 5:(s=n.sent)&&(c=r.repository.result,(p=r.entities.repositories[c])&&(p.issues={pageInfo:s.pageInfo,totalCount:s.issueCount,nodes:s.nodes},e.entities.update(Object(u.a)({repositories:Object(l.a)({},c,p)},s.entities))));case 7:case"end":return n.stop()}},n,this)}));return function(e,t){return n.apply(this,arguments)}}(),createIssue:function(){var n=Object(f.a)(d.a.mark(function n(t,r){var a,o;return d.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,h.b(t);case 2:if(!(a=n.sent)||!a.result){n.next=9;break}return(o=r.entities.repositories[r.repository.result]).issue=a.result,n.next=8,e.entities.update(Object(u.a)({},a.entities,{repositories:Object(l.a)({},r.repository.result,o)}));case 8:"function"===typeof t.callback&&t.callback("/article/".concat(a.entities.issues[a.result].number));case 9:case"end":return n.stop()}},n,this)}));return function(e,t){return n.apply(this,arguments)}}(),editIssue:function(){var n=Object(f.a)(d.a.mark(function n(t,r){var a,o;return d.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,h.c(t);case 2:if(!(a=n.sent)||!a.result){n.next=9;break}return(o=r.entities.repositories[r.repository.result]).issue=a.result,n.next=8,e.entities.update(Object(u.a)({},a.entities,{repositories:Object(l.a)({},r.repository.result,o)}));case 8:"function"===typeof t.callback&&t.callback("/article/".concat(a.entities.issues[a.result].number));case 9:case"end":return n.stop()}},n,this)}));return function(e,t){return n.apply(this,arguments)}}()}}},y=t(63),w={name:"entities",state:{repositories:{},issues:{},labels:{},milestones:{},comments:{}},reducers:{update:function(e,n){return y.merge(e,n)}}};function g(){var e=new URLSearchParams(window.location.search),n=e.get("code");if(n){e.delete("code");var t=e.toString(),r="".concat(window.location.pathname).concat(t?"?".concat(t):"").concat(window.location.hash);return window.history.pushState(null,null,r),n}return""}var v=t(63),k={user:{name:"user",state:{loading:!1,auth:!1,accessToken:"",scope:"",tokenType:"",viewer:{email:"",id:"",login:"",name:"",url:"",avatarUrl:""}},reducers:{update:function(e,n){return v.merge(e,n)}},effects:function(e){return{getAuthToken:function(){var n=Object(f.a)(d.a.mark(function n(t,r){var a,o,i,s,c,u,l,p,f;return d.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r.user.loading){n.next=3;break}return n.next=3,e.user.update({loading:!0});case 3:if(a=g(),!(o=localStorage.getItem("GITHUB_USER_AUTH"))){n.next=15;break}return i=JSON.parse(o),s=i.access_token,c=i.token_type,u=i.scope,n.next=9,Object(h.f)("".concat(c," ").concat(s));case 9:if(!(l=n.sent)){n.next=13;break}return n.next=13,e.user.update({accessToken:s,tokenType:c,scope:u,auth:!0,loading:!1,viewer:l});case 13:n.next=27;break;case 15:if(!a){n.next=27;break}return n.next=18,Object(h.j)(a);case 18:if(!(p=n.sent)||!p.access_token){n.next=27;break}return localStorage.setItem("GITHUB_USER_AUTH",JSON.stringify(p)),n.next=23,Object(h.f)("".concat(p.token_type," ").concat(p.access_token));case 23:if(!(f=n.sent)){n.next=27;break}return n.next=27,e.user.update({accessToken:p.access_token,tokenType:p.token_type,scope:p.scope,auth:!0,loading:!1,viewer:f});case 27:return n.next=29,e.user.update({loading:!1});case 29:case"end":return n.stop()}},n,this)}));return function(e,t){return n.apply(this,arguments)}}(),addComment:function(){var n=Object(f.a)(d.a.mark(function n(t,r){var a,o,i,s,c,p,f;return d.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(a=t.id,o=t.content,i=t.callback,r.user.accessToken){n.next=3;break}return n.abrupt("return");case 3:return s="".concat(r.user.tokenType," ").concat(r.user.accessToken),n.next=6,Object(h.a)({id:a,content:o,token:s});case 6:if(!(c=n.sent)){n.next=14;break}return p=r.entities.issues,(f=p[a]).comments.nodes.push(c.result),n.next=13,e.entities.update(Object(u.a)({issues:Object(l.a)({},a,f)},c.entities));case 13:"function"===typeof i&&i();case 14:case"end":return n.stop()}},n,this)}));return function(e,t){return n.apply(this,arguments)}}()}}},entities:w,repository:m},x=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function j(e,n){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;null!=t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),n&&n.onUpdate&&n.onUpdate(e)):(console.log("Content is cached for offline use."),n&&n.onSuccess&&n.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}var O=t(583),_=t(585),E=t(373),q=t(88),A=[{path:"/",exact:!0,component:Object(r.lazy)(function(){return Promise.all([t.e(1),t.e(4)]).then(t.bind(null,582))})},{path:"/editor",exact:!0,component:Object(r.lazy)(function(){return Promise.all([t.e(2),t.e(0)]).then(t.bind(null,584))})},{path:"/editor/:number",exact:!0,component:Object(r.lazy)(function(){return Promise.all([t.e(2),t.e(0)]).then(t.bind(null,584))})},{path:"/article/:number",exact:!0,component:Object(r.lazy)(function(){return Promise.all([t.e(1),t.e(5)]).then(t.bind(null,581))})}],T=function(){return a.a.createElement(O.a,null,a.a.createElement(r.Suspense,{fallback:a.a.createElement(q.a,{loading:!0})},a.a.createElement(_.a,null,A.map(function(e){return a.a.createElement(E.a,{key:e.path,path:e.path,exact:e.exact,component:function(){return a.a.createElement(e.component,null)}})}))))};t(358);t.d(n,"store",function(){return z});var z=Object(s.init)({models:k});i.a.render(a.a.createElement(c.a,{store:z},a.a.createElement(T,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var n="".concat("","/service-worker.js");x?(function(e,n){fetch(e).then(function(t){var r=t.headers.get("content-type");404===t.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):j(e,n)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(n,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")})):j(n,e)})}}()},4:function(e,n,t){"use strict";n.a={owner:"zhirui1994",repo:"zhirui1994.github.io",token:"MSt6aGlydWkxOTk0KzBhOGZmMjAwNWM3M2NmNmM1YzEzYWQyZmRkZjhjN2E4MDU0NzdlK3poaXJ1aTE5OTQuZ2l0aHViLmlvKzg=",client_id:"635ab95d562259d5e20a",client_secret:"e795e7e409ce731cf304facd92aecd305c774731"}},88:function(e,n,t){"use strict";var r=t(0),a=t.n(r),o=t(163),i=t.n(o);n.a=function(e){var n=e.children,t=e.loading;return void 0===t||t?a.a.createElement("div",{className:i.a.loadingContainer},a.a.createElement("i",{className:"fa fa-spinner fa-pulse"})):a.a.createElement(r.Fragment,null,n)}}},[[165,7,6]]]);
//# sourceMappingURL=main.74aa43a1.chunk.js.map