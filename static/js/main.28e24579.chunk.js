(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{16:function(e,t,n){"use strict";var r=n(34),a=n(2),o=n.n(a),s=n(4),i=n(20),c=n.n(i),u=n(14),p={owner:"zhirui1994",repo:"zhirui1994.github.io",token:"MSt6aGlydWkxOTk0KzBhOGZmMjAwNWM3M2NmNmM1YzEzYWQyZmRkZjhjN2E4MDU0NzdlK3poaXJ1aTE5OTQuZ2l0aHViLmlvKzg=",client_id:"635ab95d562259d5e20a",client_secret:"e795e7e409ce731cf304facd92aecd305c774731"},l=new u.b.Entity("milestones"),d=new u.b.Entity("labels"),h=new u.b.Entity("comments"),f=new u.b.Entity("issues",{milestone:l,labels:{nodes:[d]},comments:{nodes:[h]}}),m=new u.b.Entity("repositories",{issue:f,issues:{nodes:[f]},labels:{nodes:[d]},milestones:{nodes:[l]}});function b(){var e=atob(p.token),t=new RegExp("(\\+".concat(p.owner,"\\+|\\+").concat(p.repo,"\\+)"),"g");return e.replace(t,"")}function y(){return g.apply(this,arguments)}function g(){return(g=Object(s.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",c.a.post("https://api.github.com/graphql",{query:'query { \n                repository(owner: "'.concat(p.owner,'", name: "').concat(p.repo,'") {\n                    id,\n                    labels(first: 100) {\n                        nodes {\n                            id,\n                            name,\n                            color,\n                        } \n                    },\n                    milestones(first:100) {\n                        nodes {\n                            id,\n                            number,\n                            state,\n                            title,\n                        }\n                    },\n                    issues(last:20, states:OPEN) {\n                        pageInfo {\n                            endCursor,\n                            startCursor,\n                            hasNextPage,\n                            hasPreviousPage\n                        },\n                        totalCount,\n                        nodes {\n                            id,\n                            title,\n                            number,\n                            createdAt,\n                            milestone {\n                                id\n                            },\n                            labels(first:100) {\n                                nodes {\n                                    id,\n                                }\n                            }\n                        }\n                    }\n                }\n            }')},{headers:{Authorization:"bearer ".concat(b())}}).then(function(e){return Object(u.a)(e.data.data.repository,m)}));case 1:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function w(e){return k.apply(this,arguments)}function k(){return(k=Object(s.a)(o.a.mark(function e(t){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",c.a.post("https://api.github.com/graphql",{query:'query { \n                repository(owner: "'.concat(p.owner,'", name: "').concat(p.repo,'") {\n                    id,\n                    issue(number: ').concat(t,") {\n                        id,\n                        title,\n                        number,\n                        bodyHTML,\n                        createdAt,\n                        milestone {\n                            id,\n                            number,\n                            state,\n                            title,\n                        },\n                        labels(first:100) {\n                            nodes {\n                                id,\n                                name,\n                                color,\n                            }\n                        },\n                        comments(last: 20) {\n                            nodes {\n                                id,\n                                author {\n                                    avatarUrl,\n                                    login,\n                                    url,\n                                },\n                                bodyHTML,\n                                createdAt,\n                            }\n                        }\n                    }\n                }\n            }")},{headers:{Authorization:"bearer ".concat(b())}}).then(function(e){return Object(u.a)(e.data.data.repository,m)}));case 1:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function x(){var e={scope:"public_repo, user",redirect_uri:encodeURIComponent("https://zhirui1994.github.io/#/article/1"),client_id:p.client_id},t=Object.keys(e).map(function(t){return"".concat(t,"=").concat(e[t])}).join("&");return"https://github.com/login/oauth/authorize?".concat(t)}function v(e){return j.apply(this,arguments)}function j(){return(j=Object(s.a)(o.a.mark(function e(t){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return"https://cors-anywhere.herokuapp.com/https://github.com/login/oauth/access_token",e.abrupt("return",c.a.post("https://cors-anywhere.herokuapp.com/https://github.com/login/oauth/access_token",{code:t,client_id:p.client_id,client_secret:p.client_secret},{headers:{Accept:"application/json"}}).then(function(e){return e&&e.data}));case 2:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function O(e){return q.apply(this,arguments)}function q(){return(q=Object(s.a)(o.a.mark(function e(t){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",c.a.post("https://api.github.com/graphql",{query:"query { \n            viewer {\n                email,\n                id,\n                login,\n                name,\n                url,\n                avatarUrl, \n            }\n        }"},{headers:{Authorization:t}}).then(function(e){return e&&e.data&&e.data.data&&e.data.data.viewer}));case 1:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function E(e){return _.apply(this,arguments)}function _(){return(_=Object(s.a)(o.a.mark(function e(t){var n,r,a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,r=t.content,a=t.token,e.abrupt("return",c.a.post("https://api.github.com/graphql",{query:'mutation {\n                addComment(input:{subjectId: "'.concat(n,'", body: "').concat(r,'"}) {\n                    commentEdge {\n                        node {\n                            id,\n                            bodyHTML,\n                            createdAt,\n                            author {\n                                avatarUrl,\n                                login,\n                                url,\n                            },\n                        }\n                    }\n                }\n            }')},{headers:{Authorization:a}}).then(function(e){var t=e&&e.data&&e.data.data&&e.data.data.addComment.commentEdge.node;if(t)return Object(u.a)(t,h)}));case 2:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function T(){return z.apply(this,arguments)}function z(){return(z=Object(s.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",c.a.post("https://api.github.com/graphql",{query:'query {\n                repository(owner: "'.concat(p.owner,'", name: "').concat(p.repo,'") {\n                    id,\n                    labels(first: 100) {\n                        nodes {\n                            id,\n                            name,\n                            color,\n                        } \n                    },\n                    milestones(first:100) {\n                        nodes {\n                            id,\n                            number,\n                            state,\n                            title,\n                        }\n                    },\n                }\n            }')},{headers:{Authorization:"bearer ".concat(b())}}).then(function(e){var t=e&&e.data&&e.data.data&&e.data.data.repository;return!!t&&Object(u.a)(t,m)}));case 1:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function I(e){return A.apply(this,arguments)}function A(){return(A=Object(s.a)(o.a.mark(function e(t){var n;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n="repo:".concat(p.owner,"/").concat(p.repo," "),t&&t.milestone&&(n+="milestone:".concat(t.milestone," ")),t&&t.labels&&t.labels.length&&(n+=t.labels.map(function(e){return"label:".concat(e," ")}).join("")),t&&t.query&&(n+="".concat(t.query," ")),e.abrupt("return",c.a.post("https://api.github.com/graphql",{query:'query {\n                search(type: ISSUE, last: 20, query: "'.concat(n.trim(),'") {\n                    issueCount\n                    pageInfo {\n                        endCursor\n                        startCursor\n                        hasNextPage\n                        hasPreviousPage\n                    }\n                    nodes {\n                        ... on Issue {\n                            id,\n                            title,\n                            number,\n                            createdAt,\n                            milestone {\n                                id\n                            },\n                            labels(first:100) {\n                                nodes {\n                                    id,\n                                }\n                            }\n                        }\n                    }\n                }\n            }')},{headers:{Authorization:"bearer ".concat(b())}}).then(function(e){var t=e&&e.data&&e.data.data&&e.data.data.search;if(t){var n=Object(u.a)(t.nodes,[f]);return Object(r.a)({},t,{nodes:n.result,entities:n.entities})}return!1}));case 5:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}n.d(t,"f",function(){return y}),n.d(t,"c",function(){return w}),n.d(t,"b",function(){return x}),n.d(t,"h",function(){return v}),n.d(t,"d",function(){return O}),n.d(t,"a",function(){return E}),n.d(t,"e",function(){return T}),n.d(t,"g",function(){return I})},162:function(e,t,n){e.exports=n(358)},354:function(e,t,n){},358:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(158),s=n.n(o),i=n(159),c=n(87),u=n(34),p=n(24),l=n(2),d=n.n(l),h=n(4),f=n(16),m=n(62),b={name:"repository",state:{result:"",loading:!0,searchParams:{milestone:"*",labels:[],query:""}},reducers:{update:function(e,t){return m.merge(e,t)}},effects:function(e){return{initIndex:function(){var t=Object(h.a)(d.a.mark(function t(n,r){var a;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r.repository.loading){t.next=3;break}return t.next=3,e.repository.update({loading:!0});case 3:return t.next=5,f.f();case 5:if(!(a=t.sent)){t.next=11;break}return t.next=9,e.entities.update(a.entities);case 9:return t.next=11,e.repository.update({result:a.result,loading:!1});case 11:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}(),getSingleIssue:function(){var t=Object(h.a)(d.a.mark(function t(n,r){var a;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r.repository.loading){t.next=3;break}return t.next=3,e.repository.update({loading:!0});case 3:return t.next=5,f.c(n);case 5:if(!(a=t.sent)){t.next=11;break}return t.next=9,e.entities.update(a.entities);case 9:return t.next=11,e.repository.update({result:a.result,loading:!1});case 11:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}(),closeCurrentIssue:function(){var t=Object(h.a)(d.a.mark(function t(n,r){var a,o,s;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=r.repository.result,!(o=r.entities.repositories[a])){t.next=7;break}return o.issue=void 0,s={repositories:Object(p.a)({},a,o)},t.next=7,e.entities.update(s);case 7:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}(),initEditor:function(){var t=Object(h.a)(d.a.mark(function t(n,r){var a,o,s;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=r.repository.result,!((o=r.entities.repositories[a])&&o.labels&&o.labels.nodes.length&&o.milestones&&o.milestones.nodes.length)){t.next=4;break}return t.abrupt("return");case 4:if(r.repository.loading){t.next=7;break}return t.next=7,e.repository.update({loading:!0});case 7:return t.next=9,f.e();case 9:if(!(s=t.sent)){t.next=15;break}return t.next=13,e.entities.update(s.entities);case 13:return t.next=15,e.repository.update({result:s.result,loading:!1});case 15:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}(),searchIssues:function(){var t=Object(h.a)(d.a.mark(function t(n,r){var a,o,s,i,c,l;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=n.milestone,o=n.labels,s=n.query,t.next=3,e.repository.update({searchParams:{milestone:a,labels:o,query:s}});case 3:return t.next=5,f.g({milestone:a,labels:o,query:s});case 5:(i=t.sent)&&(c=r.repository.result,(l=r.entities.repositories[c])&&(l.issues={pageInfo:i.pageInfo,totalCount:i.issueCount,nodes:i.nodes},e.entities.update(Object(u.a)({repositories:Object(p.a)({},c,l)},i.entities))));case 7:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()}}},y=n(62),g={name:"entities",state:{repositories:{},issues:{},labels:{},milestones:{},comments:{}},reducers:{update:function(e,t){return y.merge(e,t)}}};function w(){var e=new URLSearchParams(window.location.search),t=e.get("code");if(t){e.delete("code");var n=e.toString(),r="".concat(window.location.pathname).concat(n?"?".concat(n):"").concat(window.location.hash);return window.history.pushState(null,null,r),t}return""}var k=n(62),x={user:{name:"user",state:{loading:!1,auth:!1,accessToken:"",scope:"",tokenType:"",viewer:{email:"",id:"",login:"",name:"",url:"",avatarUrl:""}},reducers:{update:function(e,t){return k.merge(e,t)}},effects:function(e){return{getAuthToken:function(){var t=Object(h.a)(d.a.mark(function t(n,r){var a,o,s,i,c,u,p,l,h;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r.user.loading){t.next=3;break}return t.next=3,e.user.update({loading:!0});case 3:if(a=w(),!(o=localStorage.getItem("GITHUB_USER_AUTH"))){t.next=15;break}return s=JSON.parse(o),i=s.access_token,c=s.token_type,u=s.scope,t.next=9,Object(f.d)("".concat(c," ").concat(i));case 9:if(!(p=t.sent)){t.next=13;break}return t.next=13,e.user.update({accessToken:i,tokenType:c,scope:u,auth:!0,loading:!1,viewer:p});case 13:t.next=27;break;case 15:if(!a){t.next=27;break}return t.next=18,Object(f.h)(a);case 18:if(!(l=t.sent)||!l.access_token){t.next=27;break}return localStorage.setItem("GITHUB_USER_AUTH",JSON.stringify(l)),t.next=23,Object(f.d)("".concat(l.token_type," ").concat(l.access_token));case 23:if(!(h=t.sent)){t.next=27;break}return t.next=27,e.user.update({accessToken:l.access_token,tokenType:l.token_type,scope:l.scope,auth:!0,loading:!1,viewer:h});case 27:return t.next=29,e.user.update({loading:!1});case 29:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}(),addComment:function(){var t=Object(h.a)(d.a.mark(function t(n,r){var a,o,s,i,c,l,h;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n.id,o=n.content,s=n.callback,r.user.accessToken){t.next=3;break}return t.abrupt("return");case 3:return i="".concat(r.user.tokenType," ").concat(r.user.accessToken),t.next=6,Object(f.a)({id:a,content:o,token:i});case 6:if(!(c=t.sent)){t.next=14;break}return l=r.entities.issues,(h=l[a]).comments.nodes.push(c.result),t.next=13,e.entities.update(Object(u.a)({issues:Object(p.a)({},a,h)},c.entities));case 13:"function"===typeof s&&s();case 14:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()}}},entities:g,repository:b};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var v=n(576),j=n(578),O=n(371),q=[{path:"/",exact:!0,component:Object(r.lazy)(function(){return Promise.all([n.e(0),n.e(2)]).then(n.bind(null,574))})},{path:"/editor",exact:!0,component:Object(r.lazy)(function(){return Promise.all([n.e(6),n.e(3)]).then(n.bind(null,577))})},{path:"/article/:number",exact:!0,component:Object(r.lazy)(function(){return Promise.all([n.e(0),n.e(4)]).then(n.bind(null,575))})}],E=function(){return a.a.createElement(v.a,null,a.a.createElement(r.Suspense,{fallback:a.a.createElement("div",null,"Loading...")},a.a.createElement(j.a,null,q.map(function(e){return a.a.createElement(O.a,{key:e.path,path:e.path,exact:e.exact,component:e.component})}))))};n(354);n.d(t,"store",function(){return _});var _=Object(i.init)({models:x});s.a.render(a.a.createElement(c.a,{store:_},a.a.createElement(E,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[162,7,5]]]);
//# sourceMappingURL=main.28e24579.chunk.js.map