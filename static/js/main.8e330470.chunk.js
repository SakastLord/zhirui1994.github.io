(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{15:function(e,t,n){"use strict";var r=n(22),a=n(2),o=n.n(a),s=n(3),i=n(17),c=n.n(i),u=n(9),l={owner:"zhirui1994",repo:"zhirui1994.github.io",token:"MSt6aGlydWkxOTk0KzBhOGZmMjAwNWM3M2NmNmM1YzEzYWQyZmRkZjhjN2E4MDU0NzdlK3poaXJ1aTE5OTQuZ2l0aHViLmlvKzg=",client_id:"635ab95d562259d5e20a",client_secret:"e795e7e409ce731cf304facd92aecd305c774731"},p=new u.b.Entity("milestones"),d=new u.b.Entity("labels"),f=new u.b.Entity("comments"),h=new u.b.Entity("issues",{milestone:p,labels:{nodes:[d]},comments:{nodes:[f]}}),b=new u.b.Entity("repositories",{issue:h,issues:{nodes:[h]},labels:{nodes:[d]},milestones:{nodes:[p]}});function m(){var e=atob(l.token),t=new RegExp("(\\+".concat(l.owner,"\\+|\\+").concat(l.repo,"\\+)"),"g");return e.replace(t,"")}function y(){return g.apply(this,arguments)}function g(){return(g=Object(s.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",c.a.post("https://api.github.com/graphql",{query:'query { \n                repository(owner: "'.concat(l.owner,'", name: "').concat(l.repo,'") {\n                    id,\n                    labels(first: 100) {\n                        nodes {\n                            id,\n                            name,\n                            color,\n                        } \n                    },\n                    milestones(first:100) {\n                        nodes {\n                            id,\n                            number,\n                            state,\n                            title,\n                        }\n                    },\n                    issues(last:20, states:OPEN, orderBy: {direction: DESC, field: UPDATED_AT}) {\n                        pageInfo {\n                            endCursor,\n                            startCursor,\n                            hasNextPage,\n                            hasPreviousPage\n                        },\n                        totalCount,\n                        nodes {\n                            id,\n                            title,\n                            number,\n                            createdAt,\n                            milestone {\n                                id\n                            },\n                            labels(first:100) {\n                                nodes {\n                                    id,\n                                }\n                            }\n                        }\n                    }\n                }\n            }')},{headers:{Authorization:"bearer ".concat(m())}}).then(function(e){return Object(u.a)(e.data.data.repository,b)}));case 1:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function w(e){return k.apply(this,arguments)}function k(){return(k=Object(s.a)(o.a.mark(function e(t){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",c.a.post("https://api.github.com/graphql",{query:'query { \n                repository(owner: "'.concat(l.owner,'", name: "').concat(l.repo,'") {\n                    id,\n                    issue(number: ').concat(t,") {\n                        id,\n                        title,\n                        number,\n                        bodyHTML,\n                        createdAt,\n                        milestone {\n                            id,\n                            number,\n                            state,\n                            title,\n                        },\n                        labels(first:100) {\n                            nodes {\n                                id,\n                                name,\n                                color,\n                            }\n                        },\n                        comments(last: 20) {\n                            nodes {\n                                id,\n                                author {\n                                    avatarUrl,\n                                    login,\n                                    url,\n                                },\n                                bodyHTML,\n                                createdAt,\n                            }\n                        }\n                    }\n                }\n            }")},{headers:{Authorization:"bearer ".concat(m())}}).then(function(e){return Object(u.a)(e.data.data.repository,b)}));case 1:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function x(){var e={scope:"public_repo, user",redirect_uri:encodeURIComponent("https://zhirui1994.github.io/#/article/1"),client_id:l.client_id},t=Object.keys(e).map(function(t){return"".concat(t,"=").concat(e[t])}).join("&");return"https://github.com/login/oauth/authorize?".concat(t)}function v(e){return j.apply(this,arguments)}function j(){return(j=Object(s.a)(o.a.mark(function e(t){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return"https://cors-anywhere.herokuapp.com/https://github.com/login/oauth/access_token",e.abrupt("return",c.a.post("https://cors-anywhere.herokuapp.com/https://github.com/login/oauth/access_token",{code:t,client_id:l.client_id,client_secret:l.client_secret},{headers:{Accept:"application/json"}}).then(function(e){return e&&e.data}));case 2:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function O(e){return _.apply(this,arguments)}function _(){return(_=Object(s.a)(o.a.mark(function e(t){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",c.a.post("https://api.github.com/graphql",{query:"query { \n            viewer {\n                email,\n                id,\n                login,\n                name,\n                url,\n                avatarUrl, \n            }\n        }"},{headers:{Authorization:t}}).then(function(e){return e&&e.data&&e.data.data&&e.data.data.viewer}));case 1:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function E(e){return q.apply(this,arguments)}function q(){return(q=Object(s.a)(o.a.mark(function e(t){var n,r,a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,r=t.content,a=t.token,e.abrupt("return",c.a.post("https://api.github.com/graphql",{query:'mutation {\n                addComment(input:{subjectId: "'.concat(n,'", body: "').concat(r,'"}) {\n                    commentEdge {\n                        node {\n                            id,\n                            bodyHTML,\n                            createdAt,\n                            author {\n                                avatarUrl,\n                                login,\n                                url,\n                            },\n                        }\n                    }\n                }\n            }')},{headers:{Authorization:a}}).then(function(e){var t=e&&e.data&&e.data.data&&e.data.data.addComment.commentEdge.node;if(t)return Object(u.a)(t,f)}));case 2:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function T(e){return z.apply(this,arguments)}function z(){return(z=Object(s.a)(o.a.mark(function e(t){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",c.a.post("https://api.github.com/graphql",{query:'query {\n                repository(owner: "'.concat(l.owner,'", name: "').concat(l.repo,'") {\n                    id\n                    labels(first: 100) {\n                        nodes {\n                            id\n                            name\n                            color\n                        }\n                    }\n                    milestones(first: 100) {\n                        nodes {\n                            id\n                            number\n                            state\n                            title\n                        }\n                    }\n                    ').concat(void 0!==t?"issue(number: ".concat(t,") {\n                        id\n                        title\n                        number\n                        body\n                        milestone {\n                            id\n                        }\n                        labels(first: 100) {\n                            nodes {\n                                id\n                            }\n                        }\n                    }"):"","\n                    \n                }\n            }")},{headers:{Authorization:"bearer ".concat(m())}}).then(function(e){var t=e&&e.data&&e.data.data&&e.data.data.repository;return!!t&&Object(u.a)(t,b)}));case 1:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function A(e){return I.apply(this,arguments)}function I(){return(I=Object(s.a)(o.a.mark(function e(t){var n;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n="repo:".concat(l.owner,"/").concat(l.repo," "),t&&t.milestone&&(n+="milestone:".concat(t.milestone," ")),t&&t.labels&&t.labels.length&&(n+=t.labels.map(function(e){return"label:".concat(e," ")}).join("")),t&&t.query&&(n+="".concat(t.query," ")),e.abrupt("return",c.a.post("https://api.github.com/graphql",{query:'query {\n                search(type: ISSUE, last: 20, query: "'.concat(n.trim(),'") {\n                    issueCount\n                    pageInfo {\n                        endCursor\n                        startCursor\n                        hasNextPage\n                        hasPreviousPage\n                    }\n                    nodes {\n                        ... on Issue {\n                            id,\n                            title,\n                            number,\n                            createdAt,\n                            milestone {\n                                id\n                            },\n                            labels(first:100) {\n                                nodes {\n                                    id,\n                                }\n                            }\n                        }\n                    }\n                }\n            }')},{headers:{Authorization:"bearer ".concat(m())}}).then(function(e){var t=e&&e.data&&e.data.data&&e.data.data.search;if(t){var n=Object(u.a)(t.nodes,[h]);return Object(r.a)({},t,{nodes:n.result,entities:n.entities})}return!1}));case 5:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function C(e){return P.apply(this,arguments)}function P(){return(P=Object(s.a)(o.a.mark(function e(t){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",c.a.post("https://api.github.com/repos/".concat(l.owner,"/").concat(l.repo,"/issues"),{title:t.title,body:t.body,milestone:t.milestone,labels:t.labels},{headers:{Authorization:"token ".concat(m())}}).then(function(e){var t=e&&e.data;if(t)return t.id=t.node_id,t.labels={nodes:t.labels.map(function(e){return e.id=e.node_id,e})},t.milestone.id=t.milestone.node_id,t.comments={nodes:[]},Object(u.a)(t,h)}));case 1:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function S(e){return U.apply(this,arguments)}function U(){return(U=Object(s.a)(o.a.mark(function e(t){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",c.a.patch("https://api.github.com/repos/".concat(l.owner,"/").concat(l.repo,"/issues/").concat(t.number),{title:t.title,body:t.body,milestone:t.milestone,labels:t.labels},{headers:{Authorization:"token ".concat(m())}}).then(function(e){var t=e&&e.data;if(t)return t.id=t.node_id,t.labels={nodes:t.labels.map(function(e){return e.id=e.node_id,e})},t.milestone.id=t.milestone.node_id,t.comments={nodes:[]},Object(u.a)(t,h)}));case 1:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}n.d(t,"h",function(){return y}),n.d(t,"e",function(){return w}),n.d(t,"d",function(){return x}),n.d(t,"j",function(){return v}),n.d(t,"f",function(){return O}),n.d(t,"a",function(){return E}),n.d(t,"g",function(){return T}),n.d(t,"i",function(){return A}),n.d(t,"b",function(){return C}),n.d(t,"c",function(){return S})},162:function(e,t,n){e.exports={loadingContainer:"style_loadingContainer__3W5OD"}},164:function(e,t,n){e.exports=n(365)},361:function(e,t,n){},365:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(159),s=n.n(o),i=n(160),c=n(88),u=n(22),l=n(20),p=n(2),d=n.n(p),f=n(3),h=n(15),b=n(62),m={name:"repository",state:{result:"",loading:!0,searchParams:{milestone:"*",labels:[],query:""}},reducers:{update:function(e,t){return b.merge(e,t)}},effects:function(e){return{initIndex:function(){var t=Object(f.a)(d.a.mark(function t(n,r){var a;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r.repository.loading){t.next=3;break}return t.next=3,e.repository.update({loading:!0});case 3:return t.next=5,h.h();case 5:if(!(a=t.sent)){t.next=11;break}return t.next=9,e.entities.update(a.entities);case 9:return t.next=11,e.repository.update({result:a.result,loading:!1});case 11:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}(),getSingleIssue:function(){var t=Object(f.a)(d.a.mark(function t(n,r){var a;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r.repository.loading){t.next=3;break}return t.next=3,e.repository.update({loading:!0});case 3:return t.next=5,h.e(n);case 5:if(!(a=t.sent)){t.next=11;break}return t.next=9,e.entities.update(a.entities);case 9:return t.next=11,e.repository.update({result:a.result,loading:!1});case 11:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}(),closeCurrentIssue:function(){var t=Object(f.a)(d.a.mark(function t(n,r){var a,o,s;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=r.repository.result,!(o=r.entities.repositories[a])){t.next=7;break}return o.issue=void 0,s={repositories:Object(l.a)({},a,o)},t.next=7,e.entities.update(s);case 7:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}(),initEditor:function(){var t=Object(f.a)(d.a.mark(function t(n,r){var a,o,s;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=r.repository.result,!((o=r.entities.repositories[a])&&o.labels&&o.labels.nodes.length&&o.milestones&&o.milestones.nodes.length)){t.next=4;break}return t.abrupt("return");case 4:if(r.repository.loading){t.next=7;break}return t.next=7,e.repository.update({loading:!0});case 7:return t.next=9,h.g(n);case 9:if(!(s=t.sent)){t.next=15;break}return t.next=13,e.entities.update(s.entities);case 13:return t.next=15,e.repository.update({result:s.result,loading:!1});case 15:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}(),searchIssues:function(){var t=Object(f.a)(d.a.mark(function t(n,r){var a,o,s,i,c,p;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=n.milestone,o=n.labels,s=n.query,t.next=3,e.repository.update({searchParams:{milestone:a,labels:o,query:s}});case 3:return t.next=5,h.i({milestone:a,labels:o,query:s});case 5:(i=t.sent)&&(c=r.repository.result,(p=r.entities.repositories[c])&&(p.issues={pageInfo:i.pageInfo,totalCount:i.issueCount,nodes:i.nodes},e.entities.update(Object(u.a)({repositories:Object(l.a)({},c,p)},i.entities))));case 7:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}(),createIssue:function(){var t=Object(f.a)(d.a.mark(function t(n,r){var a,o;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.b(n);case 2:if(!(a=t.sent)||!a.result){t.next=9;break}return(o=r.entities.repositories[r.repository.result]).issue=a.result,t.next=8,e.entities.update(Object(u.a)({},a.entities,{repositories:Object(l.a)({},r.repository.result,o)}));case 8:"function"===typeof n.callback&&n.callback("/article/".concat(a.entities.issues[a.result].number));case 9:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}(),editIssue:function(){var t=Object(f.a)(d.a.mark(function t(n,r){var a,o;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.c(n);case 2:if(!(a=t.sent)||!a.result){t.next=9;break}return(o=r.entities.repositories[r.repository.result]).issue=a.result,t.next=8,e.entities.update(Object(u.a)({},a.entities,{repositories:Object(l.a)({},r.repository.result,o)}));case 8:"function"===typeof n.callback&&n.callback("/article/".concat(a.entities.issues[a.result].number));case 9:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()}}},y=n(62),g={name:"entities",state:{repositories:{},issues:{},labels:{},milestones:{},comments:{}},reducers:{update:function(e,t){return y.merge(e,t)}}};function w(){var e=new URLSearchParams(window.location.search),t=e.get("code");if(t){e.delete("code");var n=e.toString(),r="".concat(window.location.pathname).concat(n?"?".concat(n):"").concat(window.location.hash);return window.history.pushState(null,null,r),t}return""}var k=n(62),x={user:{name:"user",state:{loading:!1,auth:!1,accessToken:"",scope:"",tokenType:"",viewer:{email:"",id:"",login:"",name:"",url:"",avatarUrl:""}},reducers:{update:function(e,t){return k.merge(e,t)}},effects:function(e){return{getAuthToken:function(){var t=Object(f.a)(d.a.mark(function t(n,r){var a,o,s,i,c,u,l,p,f;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r.user.loading){t.next=3;break}return t.next=3,e.user.update({loading:!0});case 3:if(a=w(),!(o=localStorage.getItem("GITHUB_USER_AUTH"))){t.next=15;break}return s=JSON.parse(o),i=s.access_token,c=s.token_type,u=s.scope,t.next=9,Object(h.f)("".concat(c," ").concat(i));case 9:if(!(l=t.sent)){t.next=13;break}return t.next=13,e.user.update({accessToken:i,tokenType:c,scope:u,auth:!0,loading:!1,viewer:l});case 13:t.next=27;break;case 15:if(!a){t.next=27;break}return t.next=18,Object(h.j)(a);case 18:if(!(p=t.sent)||!p.access_token){t.next=27;break}return localStorage.setItem("GITHUB_USER_AUTH",JSON.stringify(p)),t.next=23,Object(h.f)("".concat(p.token_type," ").concat(p.access_token));case 23:if(!(f=t.sent)){t.next=27;break}return t.next=27,e.user.update({accessToken:p.access_token,tokenType:p.token_type,scope:p.scope,auth:!0,loading:!1,viewer:f});case 27:return t.next=29,e.user.update({loading:!1});case 29:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}(),addComment:function(){var t=Object(f.a)(d.a.mark(function t(n,r){var a,o,s,i,c,p,f;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n.id,o=n.content,s=n.callback,r.user.accessToken){t.next=3;break}return t.abrupt("return");case 3:return i="".concat(r.user.tokenType," ").concat(r.user.accessToken),t.next=6,Object(h.a)({id:a,content:o,token:i});case 6:if(!(c=t.sent)){t.next=14;break}return p=r.entities.issues,(f=p[a]).comments.nodes.push(c.result),t.next=13,e.entities.update(Object(u.a)({issues:Object(l.a)({},a,f)},c.entities));case 13:"function"===typeof s&&s();case 14:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()}}},entities:g,repository:m};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var v=n(582),j=n(584),O=n(360),_=n(87),E=[{path:"/",exact:!0,component:Object(r.lazy)(function(){return Promise.all([n.e(1),n.e(4)]).then(n.bind(null,581))})},{path:"/editor",exact:!0,component:Object(r.lazy)(function(){return Promise.all([n.e(2),n.e(0)]).then(n.bind(null,583))})},{path:"/editor/:number",exact:!0,component:Object(r.lazy)(function(){return Promise.all([n.e(2),n.e(0)]).then(n.bind(null,583))})},{path:"/article/:number",exact:!0,component:Object(r.lazy)(function(){return Promise.all([n.e(1),n.e(5)]).then(n.bind(null,580))})}],q=function(){return a.a.createElement(v.a,null,a.a.createElement(r.Suspense,{fallback:a.a.createElement(_.a,{loading:!0})},a.a.createElement(j.a,null,E.map(function(e){return a.a.createElement(O.a,{key:e.path,path:e.path,exact:e.exact,component:function(){return a.a.createElement(e.component,null)}})}))))};n(361);n.d(t,"store",function(){return T});var T=Object(i.init)({models:x});s.a.render(a.a.createElement(c.a,{store:T},a.a.createElement(q,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},87:function(e,t,n){"use strict";var r=n(0),a=n.n(r),o=n(162),s=n.n(o);t.a=function(e){var t=e.children,n=e.loading;return void 0===n||n?a.a.createElement("div",{className:s.a.loadingContainer},a.a.createElement("i",{className:"fa fa-spinner fa-pulse"})):a.a.createElement(r.Fragment,null,t)}}},[[164,7,6]]]);
//# sourceMappingURL=main.8e330470.chunk.js.map